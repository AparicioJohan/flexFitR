---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# exploreHTP <a href="https://apariciojohan.github.io/exploreHTP/"><img src="man/figures/logo.png" align="right" height="160" alt="exploreHTP website" /></a>


<!-- badges: start -->
<!-- badges: end -->

exploreHTP is designed to assist researchers and plant breeders in efficiently exploring and analyzing data derived from drone imagery. This package offers a suite of tools tailored to the unique needs of plant breeding data, facilitating comprehensive data exploration, correlation analysis, data manipulation, and flexible data modeling.

## Installation

You can install the development version of exploreHTP from [GitHub](https://github.com/AparicioJohan/exploreHTP) with:

``` r
# install.packages("devtools")
devtools::install_github("AparicioJohan/exploreHTP")
```

## 1. Reading Data

This is a basic example which shows how to use exploreHTP:

```{r example}
library(exploreHTP)
data(dt_chips)

results <- dt_chips |>
  read_HTP(
    x = DAP,
    y = c(Canopy, PH),
    id = Plot,
    .keep = c(Gen, Row, Range)
  )
names(results)
```
```{r, fig.height=3, fig.dpi=600}
plot(results, type = "evolution")
```

```{r, eval=FALSE}
head(results$summ_traits)
```

```{r, echo = FALSE}
results$summ_traits |>
  head() |>
  dplyr::mutate_if(is.numeric, round, 2) |>
  kableExtra::kable()
```


```{r, echo = FALSE}
results$metadata |>
  dplyr::mutate_if(is.numeric, round, 2) |>
  kableExtra::kable()
```

## 2. Estimating days to emergence and days to full canopy

```{r, warning=FALSE, message=FALSE}
out <- canopy_HTP(x = results, index = "Canopy", id = c(60, 150))
```
```{r, fig.width= 8, fig.height=4, fig.dpi=600}
print(out)
plot(out, id = c(60, 150))
```


```{r, echo =FALSE}
out$param |>
  dplyr::mutate_if(is.numeric, round, 3) |>
  kableExtra::kable()
```

## 3. Modelling Plant Height

```{r}
ph_1 <- height_HTP(
  x = results,
  height = "PH",
  canopy = "Canopy",
  id = c(60, 150),
  fn = "fn_exp2_exp"
)
```

```{r,  fig.width= 8, fig.height=4, fig.dpi=600}
print(ph_1)
plot(ph_1, id = c(60, 150))
```

```{r, echo =FALSE}
ph_1$param |>
  dplyr::mutate_if(is.numeric, round, 3) |>
  kableExtra::kable()
```

## 4. Modelling Maturity

```{r, fig.width= 8, fig.height = 4,fig.dpi=600}
data(dt_potato)
results <- dt_potato |>
  read_HTP(
    x = DAP,
    y = c(Canopy, GLI_2),
    id = Plot,
    .keep = c(Gen, Row, Range)
  )
mat <- maturity_HTP(
  x = results,
  index = "GLI_2",
  canopy = "Canopy",
  id = c(195, 40, 20)
)
```

```{r, fig.width= 8, fig.height=4,fig.dpi=600}
print(mat)
plot(mat, id = c(195, 40))
```


```{r, echo =FALSE}
mat$param |>
  dplyr::mutate_if(is.numeric, round, 3) |>
  kableExtra::kable()
```
