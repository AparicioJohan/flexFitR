<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Modeling plant height • flexFitR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="../deps/MathJax-3.2.2/tex-chtml.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Modeling plant height">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">flexFitR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html">Home</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/how_to_start.html">Get Started</a></li>
    <li><a class="dropdown-item" href="../articles/canopy-model.html">Modeling HTP Data</a></li>
    <li><a class="dropdown-item" href="../articles/height-model.html">Modeling Plant Height</a></li>
    <li><a class="dropdown-item" href="../articles/maturity-model.html">Modeling with Constraints</a></li>
    <li><a class="dropdown-item" href="../articles/plotting.html">Plotting Options</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/AparicioJohan/flexFitR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Modeling plant height</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/AparicioJohan/flexFitR/blob/HEAD/vignettes/height-model.Rmd" class="external-link"><code>vignettes/height-model.Rmd</code></a></small>
      <div class="d-none name"><code>height-model.Rmd</code></div>
    </div>

    
    
<p>This vignette demonstrates how to use a double exponential model and
plant height data derived from UAV imagery to estimate two key
parameters:</p>
<ul>
<li>t2: the number of days it takes to reach the maximum plant
height.</li>
<li>f(t2): the maximum plant height.</li>
</ul>
<p>Before fitting any model for plant height, we will first reference
the previous vignette <a href="https://apariciojohan.github.io/flexFitR/articles/canopy-model.html">Modeling
Canopy</a> to estimate initial values for emergence, which will be used
in the double-exponential model.</p>
<p>The data in this vignette are part of Professor Jeff Endelman’s
breeding program, specifically from a partially replicated experiment.
The UAV images were collected in 2022 and processed in 2024.</p>
<div class="section level2">
<h2 id="loading-libraries">Loading libraries<a class="anchor" aria-label="anchor" href="#loading-libraries"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://apariciojohan.github.io/flexFitR/">flexFitR</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/" class="external-link">kableExtra</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/ggpubr/" class="external-link">ggpubr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="exploring-data">1. Exploring data<a class="anchor" aria-label="anchor" href="#exploring-data"></a>
</h2>
<p>We start by exploring the data using the explorer function. This
provides basic statistical summaries and visualizations, which help in
understanding the temporal evolution of the variables for each plot and
their correlations.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">dt_potato_22</span><span class="op">)</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/explorer.html">explorer</a></span><span class="op">(</span><span class="va">dt_potato_22</span>, x <span class="op">=</span> <span class="va">DAP</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">PH</span>, <span class="va">Canopy</span><span class="op">)</span>, id <span class="op">=</span> <span class="va">Plot</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "summ_vars"      "summ_metadata"  "locals_min_max" "dt_long"       </span></span>
<span><span class="co">#&gt; [5] "metadata"       "x_var"</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">results</span>, type <span class="op">=</span> <span class="st">"evolution"</span>, return_gg <span class="op">=</span> <span class="cn">TRUE</span>, add_avg <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">results</span>, type <span class="op">=</span> <span class="st">"x_by_var"</span>, return_gg <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html" class="external-link">ggarrange</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="height-model_files/figure-html/unnamed-chunk-5-1.png" alt="plot corr" width="768"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html" class="external-link">mutate_if</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">summ_vars</span>, <span class="va">var</span> <span class="op">==</span> <span class="st">"PH"</span><span class="op">)</span>, <span class="va">is.numeric</span>, <span class="va">round</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table style="width:100%;" class="table">
<colgroup>
<col width="6%">
<col width="6%">
<col width="9%">
<col width="8%">
<col width="11%">
<col width="8%">
<col width="8%">
<col width="8%">
<col width="6%">
<col width="8%">
<col width="9%">
<col width="8%">
</colgroup>
<thead><tr class="header">
<th align="left">var</th>
<th align="right">x</th>
<th align="right">Min</th>
<th align="right">Mean</th>
<th align="right">Median</th>
<th align="right">Max</th>
<th align="right">SD</th>
<th align="right">CV</th>
<th align="right">n</th>
<th align="right">miss</th>
<th align="right">miss%</th>
<th align="right">neg%</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">PH</td>
<td align="right">28</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
<td align="right">NaN</td>
<td align="right">16</td>
<td align="right">180</td>
<td align="right">0.92</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">PH</td>
<td align="right">42</td>
<td align="right">-0.02</td>
<td align="right">0.02</td>
<td align="right">0.02</td>
<td align="right">0.11</td>
<td align="right">0.02</td>
<td align="right">0.93</td>
<td align="right">196</td>
<td align="right">0</td>
<td align="right">0.00</td>
<td align="right">0.08</td>
</tr>
<tr class="odd">
<td align="left">PH</td>
<td align="right">50</td>
<td align="right">0.00</td>
<td align="right">0.15</td>
<td align="right">0.16</td>
<td align="right">0.30</td>
<td align="right">0.07</td>
<td align="right">0.45</td>
<td align="right">196</td>
<td align="right">0</td>
<td align="right">0.00</td>
<td align="right">0.01</td>
</tr>
<tr class="even">
<td align="left">PH</td>
<td align="right">62</td>
<td align="right">0.54</td>
<td align="right">0.93</td>
<td align="right">0.94</td>
<td align="right">1.21</td>
<td align="right">0.13</td>
<td align="right">0.14</td>
<td align="right">196</td>
<td align="right">0</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
</tr>
<tr class="odd">
<td align="left">PH</td>
<td align="right">77</td>
<td align="right">0.34</td>
<td align="right">0.63</td>
<td align="right">0.63</td>
<td align="right">0.79</td>
<td align="right">0.08</td>
<td align="right">0.13</td>
<td align="right">196</td>
<td align="right">0</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">PH</td>
<td align="right">84</td>
<td align="right">0.26</td>
<td align="right">0.52</td>
<td align="right">0.52</td>
<td align="right">0.73</td>
<td align="right">0.08</td>
<td align="right">0.16</td>
<td align="right">196</td>
<td align="right">0</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
</tr>
<tr class="odd">
<td align="left">PH</td>
<td align="right">96</td>
<td align="right">0.18</td>
<td align="right">0.37</td>
<td align="right">0.37</td>
<td align="right">0.61</td>
<td align="right">0.08</td>
<td align="right">0.22</td>
<td align="right">196</td>
<td align="right">0</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">PH</td>
<td align="right">105</td>
<td align="right">0.11</td>
<td align="right">0.28</td>
<td align="right">0.27</td>
<td align="right">0.52</td>
<td align="right">0.07</td>
<td align="right">0.25</td>
<td align="right">196</td>
<td align="right">0</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="estimating-days-to-emergence">2. Estimating days to emergence<a class="anchor" aria-label="anchor" href="#estimating-days-to-emergence"></a>
</h2>
<p>As previously shown in the canopy model vignette, we use a piece-wise
regression function with three parameters: t1, t2, and k. This can be
used to estimate the day of plant emergence (t1), which will later be
used as input for the double-exponential model for plant height.</p>
<p><span class="math display">\[\begin{equation}
f(t; t_1, t_2, k) =
  \begin{cases}
0 &amp; \text{if } t &lt; t_1 \\
\dfrac{k}{t_2 - t_1} \cdot (t - t_1) &amp; \text{if } t_1 \leq t \leq
t_2 \\
k &amp; \text{if } t &gt; t_2
\end{cases}
\end{equation}\]</span></p>
<p><img src="height-model_files/figure-html/unnamed-chunk-7-1.png" alt="plot fn" width="768"></p>
</div>
<div class="section level2">
<h2 id="fitting-models-for-canopy">2.1. Fitting models for canopy<a class="anchor" aria-label="anchor" href="#fitting-models-for-canopy"></a>
</h2>
<p>The parameters find here will serve as fixed parameters in the plant
height model.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fixed_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>uid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">195</span>, <span class="fl">40</span><span class="op">)</span>, k <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod_1</span> <span class="op">&lt;-</span> <span class="va">dt_potato_22</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/modeler.html">modeler</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">DAP</span>,</span>
<span>    y <span class="op">=</span> <span class="va">Canopy</span>,</span>
<span>    grp <span class="op">=</span> <span class="va">Plot</span>,</span>
<span>    fn <span class="op">=</span> <span class="st">"fn_piwise"</span>,</span>
<span>    parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>t1 <span class="op">=</span> <span class="fl">45</span>, t2 <span class="op">=</span> <span class="fl">80</span>, k <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span>,</span>
<span>    fixed_params <span class="op">=</span> <span class="va">fixed_params</span>,</span>
<span>    subset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">195</span>, <span class="fl">40</span><span class="op">)</span>,</span>
<span>    options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>add_zero <span class="op">=</span> <span class="cn">TRUE</span>, max_as_last <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod_1</span>, id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">195</span>, <span class="fl">40</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="height-model_files/figure-html/unnamed-chunk-10-1.png" alt="plot fit" width="768"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">mod_1</span><span class="op">$</span><span class="va">param</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">uid</th>
<th align="right">t1</th>
<th align="right">t2</th>
<th align="right">sse</th>
<th align="right">k</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">40</td>
<td align="right">36.97210</td>
<td align="right">64.17621</td>
<td align="right">9.550087</td>
<td align="right">100</td>
</tr>
<tr class="even">
<td align="right">195</td>
<td align="right">34.34827</td>
<td align="right">66.50274</td>
<td align="right">70.106179</td>
<td align="right">100</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="expectation-function-for-plant-height">3. Expectation function for plant height<a class="anchor" aria-label="anchor" href="#expectation-function-for-plant-height"></a>
</h2>
<p>Once the data are explored, we define the expectation function for
plant height, which in this case is a double-exponential function with
four parameters: t1, t2, <span class="math inline">\(\alpha\)</span>,
and <span class="math inline">\(\beta\)</span>. This function models the
growth dynamics of plant height over time:</p>
<p><code><a href="../reference/fn_exp2_exp.html">fn_exp2_exp()</a></code></p>
<p><span class="math display">\[\begin{equation}
f(t; t_1, t_2, \alpha, \beta) =
\begin{cases}
0 &amp; \text{if } t &lt; t_1 \\
e^{\alpha \cdot (t - t_1)^2} - 1 &amp; \text{if } t_1 \leq t \leq t_2 \\
\left(e^{\alpha \cdot (t_2 - t_1)^2} - 1\right) \cdot e^{\beta \cdot (t
- t_2)} &amp; \text{if } t &gt; t_2
\end{cases}
\end{equation}\]</span></p>
<p><img src="height-model_files/figure-html/unnamed-chunk-11-1.png" alt="plot fn" width="768"></p>
</div>
<div class="section level2">
<h2 id="fixing-parameters-and-providing-initial-values">4. Fixing parameters and providing initial values<a class="anchor" aria-label="anchor" href="#fixing-parameters-and-providing-initial-values"></a>
</h2>
<p>Before fitting the plant height model, we take the t1 values from the
canopy model and use them as fixed parameters in the plant height model.
This ensures consistency between the two models.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fixed_params</span> <span class="op">&lt;-</span> <span class="va">mod_1</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/pluck.html" class="external-link">pluck</a></span><span class="op">(</span><span class="st">"param"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">uid</span>, <span class="va">t1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">fixed_params</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">uid</th>
<th align="right">t1</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">40</td>
<td align="right">36.97210</td>
</tr>
<tr class="even">
<td align="right">195</td>
<td align="right">34.34827</td>
</tr>
</tbody>
</table>
<p>Additionally, we can specify initial values for the parameters of
each plot to improve the model’s convergence.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">initials</span> <span class="op">&lt;-</span> <span class="va">mod_1</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/pluck.html" class="external-link">pluck</a></span><span class="op">(</span><span class="st">"param"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">uid</span>, <span class="va">t1</span>, <span class="va">t2</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">600</span>, beta <span class="op">=</span> <span class="op">-</span><span class="fl">1</span> <span class="op">/</span> <span class="fl">30</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">initials</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">uid</th>
<th align="right">t1</th>
<th align="right">t2</th>
<th align="right">alpha</th>
<th align="right">beta</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">40</td>
<td align="right">36.97210</td>
<td align="right">64.17621</td>
<td align="right">0.0016667</td>
<td align="right">-0.0333333</td>
</tr>
<tr class="even">
<td align="right">195</td>
<td align="right">34.34827</td>
<td align="right">66.50274</td>
<td align="right">0.0016667</td>
<td align="right">-0.0333333</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="fitting-models-for-plant-height">5. Fitting models for plant height<a class="anchor" aria-label="anchor" href="#fitting-models-for-plant-height"></a>
</h2>
<p>To fit the model, we use the modeler function. Here:</p>
<ul>
<li>x specifies the days after planting (DAP),</li>
<li>y is the plant height variable to be modeled,</li>
<li>grp is used for grouping, allowing analysis by plot.</li>
</ul>
<p>In this example, although there are 196 plots, we will fit the model
for plots 195 and 40 as a subset. The <code>fn_exp2_exp</code> function
is defined, and we set initial values for the parameters.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod_2</span> <span class="op">&lt;-</span> <span class="va">dt_potato_22</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/modeler.html">modeler</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">DAP</span>,</span>
<span>    y <span class="op">=</span> <span class="va">PH</span>,</span>
<span>    grp <span class="op">=</span> <span class="va">Plot</span>,</span>
<span>    fn <span class="op">=</span> <span class="st">"fn_exp2_exp"</span>,</span>
<span>    parameters <span class="op">=</span> <span class="va">initials</span>,</span>
<span>    fixed_params <span class="op">=</span> <span class="va">fixed_params</span>,</span>
<span>    subset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">195</span>, <span class="fl">40</span><span class="op">)</span>,</span>
<span>    options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>add_zero <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>After fitting, we can inspect the model summary and visualize the fit
using the plot function:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod_2</span>, id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">195</span>, <span class="fl">40</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="height-model_files/figure-html/unnamed-chunk-15-1.png" alt="plot fit 2" width="768"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">mod_2</span><span class="op">$</span><span class="va">param</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">uid</th>
<th align="right">t2</th>
<th align="right">alpha</th>
<th align="right">beta</th>
<th align="right">sse</th>
<th align="right">t1</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">40</td>
<td align="right">64.55506</td>
<td align="right">0.0009623</td>
<td align="right">-0.0424267</td>
<td align="right">0.0031173</td>
<td align="right">36.97210</td>
</tr>
<tr class="even">
<td align="right">195</td>
<td align="right">62.00000</td>
<td align="right">0.0008740</td>
<td align="right">-0.0197663</td>
<td align="right">0.0144664</td>
<td align="right">34.34827</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="extracting-model-coefficients-and-uncertainty-measures">6. Extracting model coefficients and uncertainty measures<a class="anchor" aria-label="anchor" href="#extracting-model-coefficients-and-uncertainty-measures"></a>
</h2>
<p>Once the model is fitted, we can extract key statistical information,
such as the estimated coefficients, standard errors, confidence
intervals, and the variance-covariance matrix for each plot. This helps
evaluate the reliability and uncertainty of the parameter estimates.</p>
<p>The functions <code>coef</code>, <code>confint</code>, and
<code>vcov</code> are used as follows:</p>
<ul>
<li>
<strong>coef</strong>: Extracts the estimated coefficients for each
group.</li>
<li>
<strong>confint</strong>: Provides the confidence intervals for the
parameter estimates.</li>
<li>
<strong>vcov</strong>: Returns the variance-covariance matrix, which
can be used to understand the relationships between the estimates and
their variability.</li>
</ul>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">mod_2</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 6</span></span></span>
<span><span class="co">#&gt;     uid coefficient  solution std.error `t value` `Pr(&gt;|t|)`</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>    40 t2          64.6      0.551        117.     8.57<span style="color: #949494;">e</span><span style="color: #BB0000;">-10</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>    40 alpha        0.000<span style="text-decoration: underline;">962</span> 0.000<span style="text-decoration: underline;">021</span>6     44.6    1.07<span style="color: #949494;">e</span><span style="color: #BB0000;">- 7</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>    40 beta        -<span style="color: #BB0000;">0.042</span><span style="color: #BB0000; text-decoration: underline;">4</span>   0.003<span style="text-decoration: underline;">73</span>      -<span style="color: #BB0000;">11.4</span>    9.15<span style="color: #949494;">e</span><span style="color: #BB0000;">- 5</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>   195 t2          62        0.569        109.     1.23<span style="color: #949494;">e</span><span style="color: #BB0000;">- 9</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>   195 alpha        0.000<span style="text-decoration: underline;">874</span> 0.000<span style="text-decoration: underline;">039</span>1     22.3    3.35<span style="color: #949494;">e</span><span style="color: #BB0000;">- 6</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>   195 beta        -<span style="color: #BB0000;">0.019</span><span style="color: #BB0000; text-decoration: underline;">8</span>   0.002<span style="text-decoration: underline;">82</span>       -<span style="color: #BB0000;">7.00</span>   9.16<span style="color: #949494;">e</span><span style="color: #BB0000;">- 4</span></span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">mod_2</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 6</span></span></span>
<span><span class="co">#&gt;     uid coefficient  solution std.error  ci_lower  ci_upper</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>    40 t2          64.6      0.551     63.1      66.0     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>    40 alpha        0.000<span style="text-decoration: underline;">962</span> 0.000<span style="text-decoration: underline;">021</span>6  0.000<span style="text-decoration: underline;">907</span>  0.001<span style="text-decoration: underline;">02</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>    40 beta        -<span style="color: #BB0000;">0.042</span><span style="color: #BB0000; text-decoration: underline;">4</span>   0.003<span style="text-decoration: underline;">73</span>   -<span style="color: #BB0000;">0.052</span><span style="color: #BB0000; text-decoration: underline;">0</span>   -<span style="color: #BB0000;">0.032</span><span style="color: #BB0000; text-decoration: underline;">8</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>   195 t2          62        0.569     60.5      63.5     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>   195 alpha        0.000<span style="text-decoration: underline;">874</span> 0.000<span style="text-decoration: underline;">039</span>1  0.000<span style="text-decoration: underline;">773</span>  0.000<span style="text-decoration: underline;">975</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>   195 beta        -<span style="color: #BB0000;">0.019</span><span style="color: #BB0000; text-decoration: underline;">8</span>   0.002<span style="text-decoration: underline;">82</span>   -<span style="color: #BB0000;">0.027</span><span style="color: #BB0000; text-decoration: underline;">0</span>   -<span style="color: #BB0000;">0.012</span><span style="color: #BB0000; text-decoration: underline;">5</span></span></span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">mod_2</span><span class="op">)</span></span>
<span><span class="co">#&gt; $`40`</span></span>
<span><span class="co">#&gt;                  t2         alpha          beta</span></span>
<span><span class="co">#&gt; t2     3.032779e-01 -4.754961e-06 -1.730619e-03</span></span>
<span><span class="co">#&gt; alpha -4.754961e-06  4.649682e-10  3.099682e-10</span></span>
<span><span class="co">#&gt; beta  -1.730619e-03  3.099682e-10  1.388935e-05</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`195`</span></span>
<span><span class="co">#&gt;                  t2         alpha          beta</span></span>
<span><span class="co">#&gt; t2     3.235079e-01 -1.249703e-05 -6.795398e-04</span></span>
<span><span class="co">#&gt; alpha -1.249703e-05  1.531915e-09 -3.199694e-08</span></span>
<span><span class="co">#&gt; beta  -6.795398e-04 -3.199694e-08  7.969588e-06</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="predicting-maximun-plant-height">7. Predicting maximun plant height<a class="anchor" aria-label="anchor" href="#predicting-maximun-plant-height"></a>
</h2>
<p>Once we have estimated t2, which indicates the number of days it
takes to reach maximum plant height, we can use the predict function to
calculate the expected maximum height at that specific time point.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Maximum Plant Height</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mod_2</span>, x <span class="op">=</span> <span class="fl">64.5550589254</span>, id <span class="op">=</span> <span class="fl">40</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 4</span></span></span>
<span><span class="co">#&gt;     uid x_new predicted.value std.error</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>    40  64.6            1.08    0.042<span style="text-decoration: underline;">9</span></span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mod_2</span>, x <span class="op">=</span> <span class="fl">62.0000000000</span>, id <span class="op">=</span> <span class="fl">195</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 4</span></span></span>
<span><span class="co">#&gt;     uid x_new predicted.value std.error</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>   195    62           0.951    0.048<span style="text-decoration: underline;">3</span></span></span></code></pre></div>
<p>In this example, we predict the maximum plant height for plot 40 at
approximately 64.56 DAP and for plot 195 at 62.00 DAP.</p>
</div>
<div class="section level2">
<h2 id="modelling-all-plots-using-parallel-processing">8. Modelling all plots using parallel processing<a class="anchor" aria-label="anchor" href="#modelling-all-plots-using-parallel-processing"></a>
</h2>
<p>Finally, we can scale up this method to fit models for all 196 plots,
using parallel processing to accelerate the computation. By setting
<code>parallel = TRUE</code> in the options argument and specifying the
number of cores with <code><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">parallel::detectCores()</a></code>, the process
becomes much more efficient.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="va">dt_potato_22</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/modeler.html">modeler</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">DAP</span>,</span>
<span>    y <span class="op">=</span> <span class="va">PH</span>,</span>
<span>    grp <span class="op">=</span> <span class="va">Plot</span>,</span>
<span>    fn <span class="op">=</span> <span class="st">"fn_exp2_exp"</span>,</span>
<span>    parameters <span class="op">=</span> <span class="va">initials</span>,</span>
<span>    fixed_params <span class="op">=</span> <span class="va">fixed_params</span>,</span>
<span>    subset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">195</span>, <span class="fl">40</span><span class="op">)</span>,</span>
<span>    options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      add_zero <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>      max_as_last <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>      progress <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>      parallel <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>      workers <span class="op">=</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<hr>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Johan Aparicio, Jeffrey Endelman.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
