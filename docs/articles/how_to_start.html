<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>How to start • flexFitR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="../deps/MathJax-3.2.2/tex-chtml.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="How to start">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">flexFitR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html">Home</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/how_to_start.html">Get started</a></li>
    <li><a class="dropdown-item" href="../articles/canopy-model.html">Modeling</a></li>
    <li><a class="dropdown-item" href="../articles/maturity-model.html">Modeling with constraints</a></li>
    <li><a class="dropdown-item" href="../articles/predicted_values.html">Predicted values</a></li>
    <li><a class="dropdown-item" href="../articles/plotting.html">Plotting options</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/AparicioJohan/flexFitR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>How to start</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/AparicioJohan/flexFitR/blob/HEAD/vignettes/how_to_start.Rmd" class="external-link"><code>vignettes/how_to_start.Rmd</code></a></small>
      <div class="d-none name"><code>how_to_start.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="getting-started">Getting started<a class="anchor" aria-label="anchor" href="#getting-started"></a>
</h2>
<p>The basic idea of this vignette is to illustrate to users how to use
the flexFitR package. We’ll start with a very basic example: a simple
linear regression. Although this example is not the primary focus of the
package, it will serve to demonstrate its use.</p>
</div>
<div class="section level2">
<h2 id="simple-linear-regression">1. Simple linear regression<a class="anchor" aria-label="anchor" href="#simple-linear-regression"></a>
</h2>
<p>In this example, we’ll work with a small dataset consisting of 6
observations, where X is the independent variable and Y is the dependent
variable.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://apariciojohan.github.io/flexFitR/">flexFitR</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/ggpubr/" class="external-link">ggpubr</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>X <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, Y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">16</span>, <span class="fl">44</span>, <span class="fl">50</span>, <span class="fl">95</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/explorer.html">explorer</a></span><span class="op">(</span><span class="va">dt</span>, <span class="va">X</span>, <span class="va">Y</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"xy"</span><span class="op">)</span></span></code></pre></div>
<p><img src="how_to_start_files/figure-html/unnamed-chunk-3-1.png" alt="Plot x,y" width="700"></p>
<p>First, we define an objective function. In this case, the function
<code>fn_lm</code> will represent the linear regression, where b is the
intercept and m is the slope of the regression.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fn_lm</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">b</span>, <span class="va">m</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">y</span> <span class="op">&lt;-</span> <span class="va">b</span> <span class="op">+</span> <span class="va">m</span> <span class="op">*</span> <span class="va">x</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>The <code>plot_fn</code> function, which is integrated into the
package, allows us to plot any function with the parameters provided.
This is useful for visualizing the shape of the function before fitting
the model to the data.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_fn.html">plot_fn</a></span><span class="op">(</span>fn <span class="op">=</span> <span class="st">"fn_lm"</span>, params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>b <span class="op">=</span> <span class="fl">10</span>, m <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="how_to_start_files/figure-html/unnamed-chunk-5-1.png" alt="Plot function" width="700"></p>
<p>To fit the model, we use the <code>modeler</code> function. In this
function, we pass x as the independent variable, y as the dependent
variable, and then a vector of parameters where we assign initial values
to our coefficient b and coefficient m.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="va">dt</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/modeler.html">modeler</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">X</span>,</span>
<span>    y <span class="op">=</span> <span class="va">Y</span>,</span>
<span>    fn <span class="op">=</span> <span class="st">"fn_lm"</span>,</span>
<span>    parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>b <span class="op">=</span> <span class="op">-</span><span class="fl">5</span>, m <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">mod</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; Y ~ fn_lm(X, b, m) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals (`Standardized`):</span></span>
<span><span class="co">#&gt;     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. </span></span>
<span><span class="co">#&gt; -1.18875 -0.57369 -0.03282  0.00000  0.58494  1.21753 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Optimization Results `head()`:</span></span>
<span><span class="co">#&gt;  uid     b    m sse</span></span>
<span><span class="co">#&gt;    1 -15.5 19.5 449</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Metrics:</span></span>
<span><span class="co">#&gt;  Groups     Timing Convergence Iterations</span></span>
<span><span class="co">#&gt;       1 0.189 secs        100%   259 (id)</span></span></code></pre></div>
<p>Once the model is fitted, we can examine the output, extract the
estimated parameters, make some plots, and predict new x values.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod</span>, color <span class="op">=</span> <span class="st">"blue"</span>, title <span class="op">=</span> <span class="st">"Raw data"</span><span class="op">)</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod</span>, type <span class="op">=</span> <span class="fl">4</span>, n_points <span class="op">=</span> <span class="fl">200</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html" class="external-link">ggarrange</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span><span class="op">)</span></span></code></pre></div>
<p><img src="how_to_start_files/figure-html/unnamed-chunk-7-1.png" alt="Plot evolution" width="768"></p>
<p>In order to get the coefficients with their variance-covariance
matrix we make use of the <code>coef</code> and <code>vcov</code>
function, which only takes the model object as an argument.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 7</span></span></span>
<span><span class="co">#&gt;     uid fn_name coefficient solution std.error `t value` `Pr(&gt;|t|)`</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     1 fn_lm   b              -<span style="color: #BB0000;">15.5</span>      9.86     -<span style="color: #BB0000;">1.57</span>    0.192  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     1 fn_lm   m               19.5      2.53      7.71    0.001<span style="text-decoration: underline;">52</span></span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span>
<span><span class="co">#&gt; $`1`</span></span>
<span><span class="co">#&gt;           b          m</span></span>
<span><span class="co">#&gt; b  97.21937 -22.435238</span></span>
<span><span class="co">#&gt; m -22.43524   6.410068</span></span>
<span><span class="co">#&gt; attr(,"fn_name")</span></span>
<span><span class="co">#&gt; [1] "fn_lm"</span></span></code></pre></div>
<p>Finally, we can make predictions using the predict function, which
takes the fitted model as an object and X as the value for which we want
to make the prediction.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mod</span>, x <span class="op">=</span> <span class="fl">4.5</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 5</span></span></span>
<span><span class="co">#&gt;     uid fn_name x_new predicted.value std.error</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     1 fn_lm     4.5            72.3      5.01</span></span></code></pre></div>
<p>We can compare this with the lm function in R, which will give
results similar to those obtained with our package.</p>
<div class="section level3">
<h3 id="comparison-with-lm">Comparison with <code>lm</code><a class="anchor" aria-label="anchor" href="#comparison-with-lm"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X</span>, data <span class="op">=</span> <span class="va">dt</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mo</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span></span>
<span><span class="co">#&gt;              Estimate Std. Error   t value    Pr(&gt;|t|)</span></span>
<span><span class="co">#&gt; (Intercept) -15.46667   9.859988 -1.568629 0.191812151</span></span>
<span><span class="co">#&gt; X            19.51429   2.531811  7.707639 0.001524882</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">mo</span><span class="op">)</span></span>
<span><span class="co">#&gt;             (Intercept)          X</span></span>
<span><span class="co">#&gt; (Intercept)    97.21937 -22.435238</span></span>
<span><span class="co">#&gt; X             -22.43524   6.410068</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mo</span>, newdata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>X <span class="op">=</span> <span class="fl">4.5</span><span class="op">)</span>, se.fit <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; $fit</span></span>
<span><span class="co">#&gt;        1 </span></span>
<span><span class="co">#&gt; 72.34762 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $se.fit</span></span>
<span><span class="co">#&gt; [1] 5.010599</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $df</span></span>
<span><span class="co">#&gt; [1] 4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $residual.scale</span></span>
<span><span class="co">#&gt; [1] 10.59133</span></span></code></pre></div>
<p>While the previous example was fairly simple, we can consider a more
complex scenario where we need to fit not just one function, but
hundreds of functions for several groups. This can be achieved using the
<code>grp</code> argument in the <code>modeler</code> function.
Additionally, we can parallelize these processes by setting the
<code>parallel</code> argument to <code>TRUE</code> and defining the
number of cores to use.</p>
<p>It’s important to note that depending on the functions defined by the
user, some parameters may need to be constrained, such as being required
to be greater than or less than zero. In other cases, certain parameters
might need to be fixed at known values. In these more complex
situations, where we have many curves to fit and are working with
complex functions—whether non linear regressions with specific parameter
constraints or cases where some parameters are fixed for each
group—modeler offers extensive flexibility.</p>
</div>
</div>
<div class="section level2">
<h2 id="piece-wise-regression">2. Piece-wise regression<a class="anchor" aria-label="anchor" href="#piece-wise-regression"></a>
</h2>
<p>The following example, although still simple, represents a slightly
more complex function with a greater number of parameters. In this case,
we have a piece-wise regression, parameterized by <code>t1</code>,
<code>t2</code>, and <code>k</code>, and defined by the following
expression:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span>, <span class="va">t1</span> <span class="op">=</span> <span class="fl">45</span>, <span class="va">t2</span> <span class="op">=</span> <span class="fl">80</span>, <span class="va">k</span> <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">t</span> <span class="op">&lt;</span> <span class="va">t1</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">t</span> <span class="op">&gt;=</span> <span class="va">t1</span> <span class="op">&amp;&amp;</span> <span class="va">t</span> <span class="op">&lt;=</span> <span class="va">t2</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">y</span> <span class="op">&lt;-</span> <span class="va">k</span> <span class="op">/</span> <span class="op">(</span><span class="va">t2</span> <span class="op">-</span> <span class="va">t1</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="va">t</span> <span class="op">-</span> <span class="va">t1</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">y</span> <span class="op">&lt;-</span> <span class="va">k</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Before fitting the model, let’s take a look at the example
dataset.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">29</span>, <span class="fl">36</span>, <span class="fl">42</span>, <span class="fl">56</span>, <span class="fl">76</span>, <span class="fl">92</span>, <span class="fl">100</span>, <span class="fl">108</span><span class="op">)</span>,</span>
<span>  variable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0.67</span>, <span class="fl">15.11</span>, <span class="fl">77.38</span>, <span class="fl">99.81</span>, <span class="fl">99.81</span>, <span class="fl">99.81</span>, <span class="fl">99.81</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/explorer.html">explorer</a></span><span class="op">(</span><span class="va">dt</span>, <span class="va">time</span>, <span class="va">variable</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"xy"</span><span class="op">)</span></span></code></pre></div>
<p><img src="how_to_start_files/figure-html/unnamed-chunk-15-1.png" alt="Plot x,y" width="700"></p>
<p>We can make a plot of the piecewise function and then fit the model
using the <code>modeler</code> function.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_fn.html">plot_fn</a></span><span class="op">(</span>fn <span class="op">=</span> <span class="st">"fun"</span>, params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>t1 <span class="op">=</span> <span class="fl">25</span>, t2 <span class="op">=</span> <span class="fl">70</span>, k <span class="op">=</span> <span class="fl">90</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="how_to_start_files/figure-html/unnamed-chunk-16-1.png" alt="Plot function" width="700"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod_1</span> <span class="op">&lt;-</span> <span class="va">dt</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/modeler.html">modeler</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">time</span>,</span>
<span>    y <span class="op">=</span> <span class="va">variable</span>,</span>
<span>    fn <span class="op">=</span> <span class="st">"fun"</span>,</span>
<span>    parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>t1 <span class="op">=</span> <span class="fl">45</span>, t2 <span class="op">=</span> <span class="fl">80</span>, k <span class="op">=</span> <span class="fl">90</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">mod_1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; variable ~ fun(time, t1, t2, k) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals (`Standardized`):</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt;  0.0000  0.0000  0.0000  0.2722  0.0000  2.4495 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Optimization Results `head()`:</span></span>
<span><span class="co">#&gt;  uid   t1 t2    k   sse</span></span>
<span><span class="co">#&gt;    1 38.6 61 99.8 0.449</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Metrics:</span></span>
<span><span class="co">#&gt;  Groups      Timing Convergence Iterations</span></span>
<span><span class="co">#&gt;       1 0.1779 secs        100%   511 (id)</span></span></code></pre></div>
<p>After fitting the model, we can examine the results, plot the fitted
curve, extract the coefficients and their associated p-values, obtain
the variance-covariance matrix, and make predictions for unknown values
of x.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod_1</span><span class="op">)</span></span></code></pre></div>
<p><img src="how_to_start_files/figure-html/unnamed-chunk-18-1.png" alt="Plot evolution" width="700"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Coefficients</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">mod_1</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 7</span></span></span>
<span><span class="co">#&gt;     uid fn_name coefficient solution std.error `t value` `Pr(&gt;|t|)`</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     1 fun     t1              38.6    0.077<span style="text-decoration: underline;">9</span>      496.   4.54<span style="color: #949494;">e</span><span style="color: #BB0000;">-15</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     1 fun     t2              61.0    0.091<span style="text-decoration: underline;">8</span>      665.   7.82<span style="color: #949494;">e</span><span style="color: #BB0000;">-16</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>     1 fun     k               99.8    0.137       730.   4.47<span style="color: #949494;">e</span><span style="color: #BB0000;">-16</span></span></span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Variance-Covariance Matrix</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">mod_1</span><span class="op">)</span></span>
<span><span class="co">#&gt; $`1`</span></span>
<span><span class="co">#&gt;               t1           t2            k</span></span>
<span><span class="co">#&gt; t1  6.061705e-03 -0.002940001 1.877072e-07</span></span>
<span><span class="co">#&gt; t2 -2.940001e-03  0.008431400 4.204939e-03</span></span>
<span><span class="co">#&gt; k   1.877072e-07  0.004204939 1.870426e-02</span></span>
<span><span class="co">#&gt; attr(,"fn_name")</span></span>
<span><span class="co">#&gt; [1] "fun"</span></span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Making predictions</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mod_1</span>, x <span class="op">=</span> <span class="fl">45</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 5</span></span></span>
<span><span class="co">#&gt;     uid fn_name x_new predicted.value std.error</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     1 fun        45            28.5     0.223</span></span></code></pre></div>
<p>Finally, we illustrate how to provide different initial values to the
function when dealing with multiple groups, and we also show how to fix
some parameters of the objective function.</p>
<div class="section level3">
<h3 id="providing-initial-values">Providing Initial values<a class="anchor" aria-label="anchor" href="#providing-initial-values"></a>
</h3>
<p>In this example, we don’t have a grouping variable. However, by
default, the function assigns a unique identifier (<code>uid</code>) to
the dataset. Because of this, we need to specify <code>uid = 1</code>
for the initial values and fixed parameters. If there is only one group,
you only need to modify the parameters argument accordingly. This
approach is primarily for illustrative purposes.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">init</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>uid <span class="op">=</span> <span class="fl">1</span>, t1 <span class="op">=</span> <span class="fl">20</span>, t2 <span class="op">=</span> <span class="fl">30</span>, k <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mod_2</span> <span class="op">&lt;-</span> <span class="va">dt</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/modeler.html">modeler</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">time</span>,</span>
<span>    y <span class="op">=</span> <span class="va">variable</span>,</span>
<span>    fn <span class="op">=</span> <span class="st">"fun"</span>,</span>
<span>    parameters <span class="op">=</span> <span class="va">init</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">mod_2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; variable ~ fun(time, t1, t2, k) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals (`Standardized`):</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt;  0.0000  0.0000  0.0000  0.2722  0.0000  2.4495 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Optimization Results `head()`:</span></span>
<span><span class="co">#&gt;  uid   t1 t2    k   sse</span></span>
<span><span class="co">#&gt;    1 38.6 61 99.8 0.449</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Metrics:</span></span>
<span><span class="co">#&gt;  Groups      Timing Convergence Iterations</span></span>
<span><span class="co">#&gt;       1 0.2632 secs        100%   567 (id)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">mod_2</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 7</span></span></span>
<span><span class="co">#&gt;     uid fn_name coefficient solution std.error `t value` `Pr(&gt;|t|)`</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     1 fun     t1              38.6    0.077<span style="text-decoration: underline;">9</span>      496.   4.54<span style="color: #949494;">e</span><span style="color: #BB0000;">-15</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     1 fun     t2              61.0    0.091<span style="text-decoration: underline;">8</span>      665.   7.82<span style="color: #949494;">e</span><span style="color: #BB0000;">-16</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>     1 fun     k               99.8    0.137       730.   4.47<span style="color: #949494;">e</span><span style="color: #BB0000;">-16</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="fixing-parameters">Fixing parameters<a class="anchor" aria-label="anchor" href="#fixing-parameters"></a>
</h3>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>uid <span class="op">=</span> <span class="fl">1</span>, k <span class="op">=</span> <span class="fl">98</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mod_3</span> <span class="op">&lt;-</span> <span class="va">dt</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/modeler.html">modeler</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">time</span>,</span>
<span>    y <span class="op">=</span> <span class="va">variable</span>,</span>
<span>    fn <span class="op">=</span> <span class="st">"fun"</span>,</span>
<span>    parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>t1 <span class="op">=</span> <span class="fl">45</span>, t2 <span class="op">=</span> <span class="fl">80</span>, k <span class="op">=</span> <span class="fl">90</span><span class="op">)</span>,</span>
<span>    fixed_params <span class="op">=</span> <span class="va">fix</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">mod_3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; variable ~ fun(time, t1, t2, k) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals (`Standardized`):</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt;  0.0000  0.0000  0.4815  0.6316  1.3008  1.3008 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Optimization Results `head()`:</span></span>
<span><span class="co">#&gt;  uid   t1   t2  sse  k</span></span>
<span><span class="co">#&gt;    1 38.6 60.6 13.6 98</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Metrics:</span></span>
<span><span class="co">#&gt;  Groups      Timing Convergence Iterations</span></span>
<span><span class="co">#&gt;       1 0.1705 secs        100%   321 (id)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">mod_3</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 7</span></span></span>
<span><span class="co">#&gt;     uid fn_name coefficient solution std.error `t value` `Pr(&gt;|t|)`</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     1 fun     t1              38.6     0.396      97.5   3.15<span style="color: #949494;">e</span><span style="color: #BB0000;">-12</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     1 fun     t2              60.6     0.429     141.    2.34<span style="color: #949494;">e</span><span style="color: #BB0000;">-13</span></span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod_3</span><span class="op">)</span></span></code></pre></div>
<p><img src="how_to_start_files/figure-html/unnamed-chunk-23-1.png" alt="Plot evolution" width="700"></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/performance.html">performance</a></span><span class="op">(</span><span class="va">mod_1</span>, <span class="va">mod_2</span>, <span class="va">mod_3</span><span class="op">)</span></span>
<span><span class="co">#&gt;   fn_name uid df nobs p logLik   AIC  AICc   BIC Sigma   SSE  MAE  MSE RMSE R2</span></span>
<span><span class="co">#&gt; 1   fun_1   1  4    9 3   0.72  6.56 16.56  7.35  0.27  0.45 0.07 0.05 0.22  1</span></span>
<span><span class="co">#&gt; 2   fun_2   1  4    9 3   0.72  6.56 16.56  7.35  0.27  0.45 0.07 0.05 0.22  1</span></span>
<span><span class="co">#&gt; 3   fun_3   1  3    9 2 -14.61 35.23 40.03 35.82  1.39 13.55 0.88 1.51 1.23  1</span></span></code></pre></div>
<p>This vignette provided a basic introduction to using the flexFitR
package, starting with simple examples such as linear regression and
piecewise regression. The goal was to demonstrate the fundamental
features and flexibility of the package. However, more complex
situations can arise when working with high-throughput phenotypic (HTP)
data, which involve multiple groups, parameter constraints, and advanced
modeling scenarios. These more complex situations are illustrated in the
other vignettes, which use real HTP data to showcase the full
capabilities of the flexFitR package.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Johan Aparicio, Jeffrey Endelman.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
