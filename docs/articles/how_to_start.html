<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="exploreHTP">
<title>How to start • exploreHTP</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="How to start">
<meta property="og:description" content="exploreHTP">
<meta property="og:image" content="https://apariciojohan.github.io/exploreHTP/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-default navbar-expand-lg bg-secondary" data-bs-theme="default"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">exploreHTP</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../index.html">Home</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/how_to_start.html">Get Started</a>
    <a class="dropdown-item" href="../articles/canopy-model.html">Modeling HTP Data 1</a>
    <a class="dropdown-item" href="../articles/height-model.html">Modeling HTP Data 2</a>
    <a class="dropdown-item" href="../articles/maturity-model.html">Modeling HTP Data 3</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/AparicioJohan/exploreHTP">
    <span class="fa fa-github"></span>
     
    Github
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>How to start</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/AparicioJohan/exploreHTP/blob/HEAD/vignettes/how_to_start.Rmd" class="external-link"><code>vignettes/how_to_start.Rmd</code></a></small>
      <div class="d-none name"><code>how_to_start.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="getting-started">Getting started<a class="anchor" aria-label="anchor" href="#getting-started"></a>
</h2>
<p>The basic idea of this vignette is to illustrate to users how to use
the exploreHTP package. We’ll start with a very basic example: a simple
linear regression. Although this example is not the primary focus of the
package, it will serve to demonstrate its use.</p>
</div>
<div class="section level2">
<h2 id="simple-linear-regression">1. Simple linear regression<a class="anchor" aria-label="anchor" href="#simple-linear-regression"></a>
</h2>
<p>In this example, we’ll work with a small dataset consisting of 6
observations, where X is the independent variable and Y is the dependent
variable.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://apariciojohan.github.io/exploreHTP/">exploreHTP</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>X <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, Y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">16</span>, <span class="fl">44</span>, <span class="fl">50</span>, <span class="fl">95</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dt</span><span class="op">$</span><span class="va">X</span>, <span class="va">dt</span><span class="op">$</span><span class="va">Y</span><span class="op">)</span></span></code></pre></div>
<p><img src="how_to_start_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<p>First, we define an objective function. In this case, the function
<code>fn_lm</code> will represent the linear regression, where b is the
intercept and m is the slope of the regression.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fn_lm</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">b</span>, <span class="va">m</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">y</span> <span class="op">&lt;-</span> <span class="va">b</span> <span class="op">+</span> <span class="va">m</span> <span class="op">*</span> <span class="va">x</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>The <code>plot_fn</code> function, which is integrated into the
package, allows us to plot any function with the parameters provided.
This is useful for visualizing the shape of the function before fitting
the model to the data.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_fn.html">plot_fn</a></span><span class="op">(</span>fn <span class="op">=</span> <span class="st">"fn_lm"</span>, params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>b <span class="op">=</span> <span class="fl">10</span>, m <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="how_to_start_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>To fit the model, we use the <code>modeler_HTP</code> function. In
this function, we pass x as the independent variable, y as the dependent
variable, and then a vector of parameters where we assign initial values
to our coefficient b and coefficient m.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="va">dt</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/modeler_HTP.html">modeler_HTP</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">X</span>,</span>
<span>    y <span class="op">=</span> <span class="va">Y</span>,</span>
<span>    parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>b <span class="op">=</span> <span class="op">-</span><span class="fl">5</span>, m <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>    fn <span class="op">=</span> <span class="st">"fn_lm"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">mod</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; Y ~ fn_lm(x, b, m) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. </span></span>
<span><span class="co">#&gt; -12.5905  -6.0762  -0.3476   0.0000   6.1952  12.8952 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Optimization Results `head()`:</span></span>
<span><span class="co">#&gt;  uid     b    m sse auc</span></span>
<span><span class="co">#&gt;    1 -15.5 19.5 449 258</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Metrics:</span></span>
<span><span class="co">#&gt;  Ids      Timing Convergence Iterations</span></span>
<span><span class="co">#&gt;    1 0.5373 secs        100%   259 (id)</span></span></code></pre></div>
<p>Once the model is fitted, we can examine the output, extract the
estimated parameters, make some plots, and predict new x values.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span></code></pre></div>
<p><img src="how_to_start_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<p>In order to get the coefficients with their variance-covariance
matrix we make use of the <code>coef</code> and <code>vcov</code>
function, which only takes the model object as an argument.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 6</span></span></span>
<span><span class="co">#&gt;     uid coefficient solution std.error `t value` `Pr(&gt;|t|)`</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     1 b              -<span style="color: #BB0000;">15.5</span>      9.86     -<span style="color: #BB0000;">1.57</span>    0.192  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     1 m               19.5      2.53      7.71    0.001<span style="text-decoration: underline;">52</span></span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span>
<span><span class="co">#&gt; $`1`</span></span>
<span><span class="co">#&gt;           b          m</span></span>
<span><span class="co">#&gt; b  97.21937 -22.435238</span></span>
<span><span class="co">#&gt; m -22.43524   6.410068</span></span></code></pre></div>
<p>Finally, we can make predictions using the predict function, which
takes the fitted model as an object and X as the value for which we want
to make the prediction.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mod</span>, x <span class="op">=</span> <span class="fl">4.5</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 4</span></span></span>
<span><span class="co">#&gt;     uid x_new predicted.value std.error</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     1   4.5            72.3      5.01</span></span></code></pre></div>
<p>We can compare this with the lm function in R, which will give
results similar to those obtained with our package.</p>
<div class="section level3">
<h3 id="comparison-with-lm">Comparison with <code>lm</code><a class="anchor" aria-label="anchor" href="#comparison-with-lm"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X</span>, data <span class="op">=</span> <span class="va">dt</span><span class="op">)</span></span>
<span><span class="va">mo</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = Y ~ X, data = dt)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt; (Intercept)            X  </span></span>
<span><span class="co">#&gt;      -15.47        19.51</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mo</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span></span>
<span><span class="co">#&gt;              Estimate Std. Error   t value    Pr(&gt;|t|)</span></span>
<span><span class="co">#&gt; (Intercept) -15.46667   9.859988 -1.568629 0.191812151</span></span>
<span><span class="co">#&gt; X            19.51429   2.531811  7.707639 0.001524882</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">mo</span><span class="op">)</span></span>
<span><span class="co">#&gt;             (Intercept)          X</span></span>
<span><span class="co">#&gt; (Intercept)    97.21937 -22.435238</span></span>
<span><span class="co">#&gt; X             -22.43524   6.410068</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mo</span>, newdata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>X <span class="op">=</span> <span class="fl">4.5</span><span class="op">)</span>, se.fit <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; $fit</span></span>
<span><span class="co">#&gt;        1 </span></span>
<span><span class="co">#&gt; 72.34762 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $se.fit</span></span>
<span><span class="co">#&gt; [1] 5.010599</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $df</span></span>
<span><span class="co">#&gt; [1] 4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $residual.scale</span></span>
<span><span class="co">#&gt; [1] 10.59133</span></span></code></pre></div>
<p>While the previous example was fairly simple, we can consider a more
complex scenario where we need to fit not just one function, but
hundreds of functions for several groups. This can be achieved using the
<code>by</code> argument in the <code>modeler_HTP</code> function.
Additionally, we can parallelize these processes by setting the
<code>parallel</code> argument to <code>TRUE</code> and defining the
number of cores to use.</p>
<p>It’s important to note that depending on the functions defined by the
user, some parameters may need to be constrained, such as being required
to be greater than or less than zero. In other cases, certain parameters
might need to be fixed at known values. In these more complex
situations, where we have many curves to fit and are working with
complex functions—whether non linear regressions with specific parameter
constraints or cases where some parameters are fixed for each
group—modeler_HTP offers extensive flexibility.</p>
</div>
</div>
<div class="section level2">
<h2 id="piece-wise-regression">2. Piece-wise regression<a class="anchor" aria-label="anchor" href="#piece-wise-regression"></a>
</h2>
<p>The following example, although still simple, represents a slightly
more complex function with a greater number of parameters. In this case,
we have a piece-wise regression, parameterized by <code>t1</code>,
<code>t2</code>, and <code>k</code>, and defined by the following
expression:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span>, <span class="va">t1</span> <span class="op">=</span> <span class="fl">45</span>, <span class="va">t2</span> <span class="op">=</span> <span class="fl">80</span>, <span class="va">k</span> <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">t</span> <span class="op">&lt;</span> <span class="va">t1</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">t</span> <span class="op">&gt;=</span> <span class="va">t1</span> <span class="op">&amp;&amp;</span> <span class="va">t</span> <span class="op">&lt;=</span> <span class="va">t2</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">y</span> <span class="op">&lt;-</span> <span class="va">k</span> <span class="op">/</span> <span class="op">(</span><span class="va">t2</span> <span class="op">-</span> <span class="va">t1</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="va">t</span> <span class="op">-</span> <span class="va">t1</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">y</span> <span class="op">&lt;-</span> <span class="va">k</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>We can plot the piecewise function and then fit the model using the
<code>modeler_HTP</code> function. After fitting the model, we can
examine the results, plot the fitted curve, extract the coefficients and
their associated p-values, obtain the variance-covariance matrix, and
make predictions for unknown values of x.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_fn.html">plot_fn</a></span><span class="op">(</span>fn <span class="op">=</span> <span class="st">"fun"</span>, params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>t1 <span class="op">=</span> <span class="fl">30</span>, t2 <span class="op">=</span> <span class="fl">60</span>, k <span class="op">=</span> <span class="fl">90</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="how_to_start_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">29</span>, <span class="fl">36</span>, <span class="fl">42</span>, <span class="fl">56</span>, <span class="fl">76</span>, <span class="fl">92</span>, <span class="fl">100</span>, <span class="fl">108</span><span class="op">)</span>,</span>
<span>  variable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0.67</span>, <span class="fl">15.11</span>, <span class="fl">77.38</span>, <span class="fl">99.81</span>, <span class="fl">99.81</span>, <span class="fl">99.81</span>, <span class="fl">99.81</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dt</span><span class="op">$</span><span class="va">time</span>, <span class="va">dt</span><span class="op">$</span><span class="va">variable</span><span class="op">)</span></span></code></pre></div>
<p><img src="how_to_start_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod_1</span> <span class="op">&lt;-</span> <span class="va">dt</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/modeler_HTP.html">modeler_HTP</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">time</span>,</span>
<span>    y <span class="op">=</span> <span class="va">variable</span>,</span>
<span>    parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>t1 <span class="op">=</span> <span class="fl">45</span>, t2 <span class="op">=</span> <span class="fl">80</span>, k <span class="op">=</span> <span class="fl">90</span><span class="op">)</span>,</span>
<span>    fn <span class="op">=</span> <span class="st">"fun"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">mod_1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; variable ~ fun(x, t1, t2, k) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt; 0.00000 0.00000 0.00000 0.07444 0.00000 0.67000 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Optimization Results `head()`:</span></span>
<span><span class="co">#&gt;  uid   t1 t2    k   sse  auc</span></span>
<span><span class="co">#&gt;    1 38.6 61 99.8 0.449 5807</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Metrics:</span></span>
<span><span class="co">#&gt;  Ids     Timing Convergence Iterations</span></span>
<span><span class="co">#&gt;    1 0.545 secs        100%   511 (id)</span></span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod_1</span><span class="op">)</span></span></code></pre></div>
<p><img src="how_to_start_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Coefficients</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">mod_1</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 6</span></span></span>
<span><span class="co">#&gt;     uid coefficient solution std.error `t value` `Pr(&gt;|t|)`</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     1 t1              38.6    0.077<span style="text-decoration: underline;">9</span>      496.   4.54<span style="color: #949494;">e</span><span style="color: #BB0000;">-15</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     1 t2              61.0    0.091<span style="text-decoration: underline;">8</span>      665.   7.82<span style="color: #949494;">e</span><span style="color: #BB0000;">-16</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>     1 k               99.8    0.137       730.   4.47<span style="color: #949494;">e</span><span style="color: #BB0000;">-16</span></span></span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Variance-Covariance Matrix</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">mod_1</span><span class="op">)</span></span>
<span><span class="co">#&gt; $`1`</span></span>
<span><span class="co">#&gt;               t1           t2            k</span></span>
<span><span class="co">#&gt; t1  6.061705e-03 -0.002940001 1.877072e-07</span></span>
<span><span class="co">#&gt; t2 -2.940001e-03  0.008431400 4.204939e-03</span></span>
<span><span class="co">#&gt; k   1.877072e-07  0.004204939 1.870426e-02</span></span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Making predictions</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mod_1</span>, x <span class="op">=</span> <span class="fl">45</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 4</span></span></span>
<span><span class="co">#&gt;     uid x_new predicted.value std.error</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     1    45            28.5     0.223</span></span></code></pre></div>
<p>Finally, we illustrate how to provide different initial values to the
function when dealing with multiple groups, and we also show how to fix
some parameters of the objective function.</p>
<div class="section level3">
<h3 id="providing-initial-values">Providing Initial values<a class="anchor" aria-label="anchor" href="#providing-initial-values"></a>
</h3>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">init</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>uid <span class="op">=</span> <span class="fl">1</span>, t1 <span class="op">=</span> <span class="fl">20</span>, t2 <span class="op">=</span> <span class="fl">30</span>, k <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mod_2</span> <span class="op">&lt;-</span> <span class="va">dt</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/modeler_HTP.html">modeler_HTP</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">time</span>,</span>
<span>    y <span class="op">=</span> <span class="va">variable</span>,</span>
<span>    parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>t1 <span class="op">=</span> <span class="fl">45</span>, t2 <span class="op">=</span> <span class="fl">80</span>, k <span class="op">=</span> <span class="fl">90</span><span class="op">)</span>,</span>
<span>    fn <span class="op">=</span> <span class="st">"fun"</span>,</span>
<span>    initial_vals <span class="op">=</span> <span class="va">init</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">mod_2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; variable ~ fun(x, t1, t2, k) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt; 0.00000 0.00000 0.00000 0.07444 0.00000 0.67000 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Optimization Results `head()`:</span></span>
<span><span class="co">#&gt;  uid   t1 t2    k   sse  auc</span></span>
<span><span class="co">#&gt;    1 38.6 61 99.8 0.449 5807</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Metrics:</span></span>
<span><span class="co">#&gt;  Ids      Timing Convergence Iterations</span></span>
<span><span class="co">#&gt;    1 0.5506 secs        100%   567 (id)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">mod_2</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 6</span></span></span>
<span><span class="co">#&gt;     uid coefficient solution std.error `t value` `Pr(&gt;|t|)`</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     1 t1              38.6    0.077<span style="text-decoration: underline;">9</span>      496.   4.54<span style="color: #949494;">e</span><span style="color: #BB0000;">-15</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     1 t2              61.0    0.091<span style="text-decoration: underline;">8</span>      665.   7.82<span style="color: #949494;">e</span><span style="color: #BB0000;">-16</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>     1 k               99.8    0.137       730.   4.47<span style="color: #949494;">e</span><span style="color: #BB0000;">-16</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="fixing-parameters">Fixing parameters<a class="anchor" aria-label="anchor" href="#fixing-parameters"></a>
</h3>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>uid <span class="op">=</span> <span class="fl">1</span>, k <span class="op">=</span> <span class="fl">98</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mod_3</span> <span class="op">&lt;-</span> <span class="va">dt</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/modeler_HTP.html">modeler_HTP</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">time</span>,</span>
<span>    y <span class="op">=</span> <span class="va">variable</span>,</span>
<span>    parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>t1 <span class="op">=</span> <span class="fl">45</span>, t2 <span class="op">=</span> <span class="fl">80</span>, k <span class="op">=</span> <span class="fl">90</span><span class="op">)</span>,</span>
<span>    fn <span class="op">=</span> <span class="st">"fun"</span>,</span>
<span>    fixed_params <span class="op">=</span> <span class="va">fix</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">mod_3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; variable ~ fun(x, t1, t2, k) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt;  0.0000  0.0000  0.6700  0.8789  1.8100  1.8100 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Optimization Results `head()`:</span></span>
<span><span class="co">#&gt;  uid   t1   t2  sse  k  auc</span></span>
<span><span class="co">#&gt;    1 38.6 60.6 13.6 98 5721</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Metrics:</span></span>
<span><span class="co">#&gt;  Ids      Timing Convergence Iterations</span></span>
<span><span class="co">#&gt;    1 0.5039 secs        100%   321 (id)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">mod_3</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 6</span></span></span>
<span><span class="co">#&gt;     uid coefficient solution std.error `t value` `Pr(&gt;|t|)`</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     1 t1              38.6     0.396      97.5   3.15<span style="color: #949494;">e</span><span style="color: #BB0000;">-12</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     1 t2              60.6     0.429     141.    2.34<span style="color: #949494;">e</span><span style="color: #BB0000;">-13</span></span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod_3</span><span class="op">)</span></span></code></pre></div>
<p><img src="how_to_start_files/figure-html/unnamed-chunk-23-1.png" width="700"></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="../reference/metrics_HTP.html">metrics_HTP</a></span><span class="op">(</span><span class="va">mod_1</span><span class="op">)</span>, <span class="fu"><a href="../reference/metrics_HTP.html">metrics_HTP</a></span><span class="op">(</span><span class="va">mod_2</span><span class="op">)</span>, <span class="fu"><a href="../reference/metrics_HTP.html">metrics_HTP</a></span><span class="op">(</span><span class="va">mod_3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 8</span></span></span>
<span><span class="co">#&gt;     uid var         SSE    MAE    MSE  RMSE r_squared     n</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     1 variable  0.449 0.074<span style="text-decoration: underline;">4</span> 0.049<span style="text-decoration: underline;">9</span> 0.223     1.00      9</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     1 variable  0.449 0.074<span style="text-decoration: underline;">4</span> 0.049<span style="text-decoration: underline;">9</span> 0.223     1.00      9</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>     1 variable 13.6   0.879  1.51   1.23      0.999     9</span></span></code></pre></div>
<p>This vignette provided a basic introduction to using the exploreHTP
package, starting with simple examples such as linear regression and
piecewise regression. The goal was to demonstrate the fundamental
features and flexibility of the package. However, more complex
situations can arise when working with high-throughput phenotypic (HTP)
data, which involve multiple groups, parameter constraints, and advanced
modeling scenarios. These more complex situations are illustrated in the
other vignettes, which use real HTP data to showcase the full
capabilities of the exploreHTP package.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Johan Aparicio, Jeffrey Endelman.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
