<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Modeling â€¢ flexFitR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="../deps/MathJax-3.2.2/tex-chtml.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Modeling">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">flexFitR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html">Home</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/how_to_start.html">Get started</a></li>
    <li><a class="dropdown-item" href="../articles/canopy-model.html">Modeling</a></li>
    <li><a class="dropdown-item" href="../articles/maturity-model.html">Modeling with constraints</a></li>
    <li><a class="dropdown-item" href="../articles/predicted_values.html">Predicted values</a></li>
    <li><a class="dropdown-item" href="../articles/plotting.html">Plotting options</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/AparicioJohan/flexFitR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Modeling</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/AparicioJohan/flexFitR/blob/HEAD/vignettes/canopy-model.Rmd" class="external-link"><code>vignettes/canopy-model.Rmd</code></a></small>
      <div class="d-none name"><code>canopy-model.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="modeling-plant-emergence-and-canopy-growth-using-uav-data">Modeling plant emergence and canopy growth using UAV data<a class="anchor" aria-label="anchor" href="#modeling-plant-emergence-and-canopy-growth-using-uav-data"></a>
</h2>
<p>This vignette demonstrates piecewise regression using canopy data
derived from UAV imagery to estimate two key parameters:</p>
<ul>
<li>t1: days to plant emergence.</li>
<li>t2: days to reach maximum canopy.</li>
</ul>
<p>The data are from the University of Wisconsin-Madison potato breeding
program, specifically for a partially replicated experiment. The UAV
images were collected in 2020 and processed in 2024.</p>
</div>
<div class="section level2">
<h2 id="loading-libraries">Loading libraries<a class="anchor" aria-label="anchor" href="#loading-libraries"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://apariciojohan.github.io/flexFitR/">flexFitR</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/" class="external-link">kableExtra</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/ggpubr/" class="external-link">ggpubr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="exploring-data">1. Exploring data<a class="anchor" aria-label="anchor" href="#exploring-data"></a>
</h2>
<p>We begin with the explorer function, which provides basic statistical
summaries and descriptive statistics, as well as visualizations to help
understand the temporal evolution of each plot.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">dt_potato</span><span class="op">)</span></span>
<span><span class="va">explorer</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/explorer.html">explorer</a></span><span class="op">(</span><span class="va">dt_potato</span>, x <span class="op">=</span> <span class="va">DAP</span>, y <span class="op">=</span> <span class="va">Canopy</span>, id <span class="op">=</span> <span class="va">Plot</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">explorer</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "summ_vars"      "summ_metadata"  "locals_min_max" "dt_long"       </span></span>
<span><span class="co">#&gt; [5] "metadata"       "x_var"</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">explorer</span>, type <span class="op">=</span> <span class="st">"evolution"</span>, return_gg <span class="op">=</span> <span class="cn">TRUE</span>, add_avg <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">explorer</span>, type <span class="op">=</span> <span class="st">"x_by_var"</span>, return_gg <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html" class="external-link">ggarrange</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span><span class="op">)</span></span></code></pre></div>
<p><img src="canopy-model_files/figure-html/unnamed-chunk-5-1.png" alt="plot corr" width="768"></p>
<p>To see more about the type of plots visit
<code><a href="../reference/plot.explorer.html">plot.explorer()</a></code>.</p>
<table style="width:100%;" class="table">
<colgroup>
<col width="10%">
<col width="5%">
<col width="8%">
<col width="8%">
<col width="10%">
<col width="10%">
<col width="8%">
<col width="7%">
<col width="5%">
<col width="7%">
<col width="8%">
<col width="7%">
</colgroup>
<thead><tr class="header">
<th align="left">var</th>
<th align="right">x</th>
<th align="right">Min</th>
<th align="right">Mean</th>
<th align="right">Median</th>
<th align="right">Max</th>
<th align="right">SD</th>
<th align="right">CV</th>
<th align="right">n</th>
<th align="right">miss</th>
<th align="right">miss%</th>
<th align="right">neg%</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Canopy</td>
<td align="right">0</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
<td align="right">NaN</td>
<td align="right">196</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">Canopy</td>
<td align="right">29</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
<td align="right">NaN</td>
<td align="right">196</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">Canopy</td>
<td align="right">36</td>
<td align="right">0.00</td>
<td align="right">2.95</td>
<td align="right">1.84</td>
<td align="right">15.09</td>
<td align="right">3.22</td>
<td align="right">1.09</td>
<td align="right">196</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">Canopy</td>
<td align="right">42</td>
<td align="right">0.76</td>
<td align="right">23.38</td>
<td align="right">22.91</td>
<td align="right">46.23</td>
<td align="right">9.31</td>
<td align="right">0.40</td>
<td align="right">196</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">Canopy</td>
<td align="right">56</td>
<td align="right">32.51</td>
<td align="right">75.20</td>
<td align="right">74.96</td>
<td align="right">98.62</td>
<td align="right">12.26</td>
<td align="right">0.16</td>
<td align="right">196</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">Canopy</td>
<td align="right">76</td>
<td align="right">89.06</td>
<td align="right">99.72</td>
<td align="right">100.00</td>
<td align="right">100.00</td>
<td align="right">1.04</td>
<td align="right">0.01</td>
<td align="right">196</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">Canopy</td>
<td align="right">92</td>
<td align="right">89.06</td>
<td align="right">99.75</td>
<td align="right">100.00</td>
<td align="right">100.04</td>
<td align="right">1.02</td>
<td align="right">0.01</td>
<td align="right">196</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">Canopy</td>
<td align="right">100</td>
<td align="right">89.06</td>
<td align="right">99.75</td>
<td align="right">100.00</td>
<td align="right">100.04</td>
<td align="right">1.02</td>
<td align="right">0.01</td>
<td align="right">196</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="regression-function">2. Regression Function<a class="anchor" aria-label="anchor" href="#regression-function"></a>
</h2>
<p>Once the data have been explored, we define the expectation function.
In this case, it is a piece-wise regression function with three
parameters: t1, t2, and k. The function can be expressed mathematically
as follows:</p>
<p><code><a href="../reference/fn_lin_plat.html">fn_lin_plat()</a></code></p>
<p><span class="math display">\[\begin{equation}
f(t; t_1, t_2, k) =
\begin{cases}
0 &amp; \text{if } t &lt; t_1 \\
\dfrac{k}{t_2 - t_1} \cdot (t - t_1) &amp; \text{if } t_1 \leq t \leq
t_2 \\
k &amp; \text{if } t &gt; t_2
\end{cases}
\end{equation}\]</span></p>
<p><img src="canopy-model_files/figure-html/unnamed-chunk-7-1.png" alt="plot fn" width="768"></p>
</div>
<div class="section level2">
<h2 id="fitting-models">3. Fitting Models<a class="anchor" aria-label="anchor" href="#fitting-models"></a>
</h2>
<p>To fit the model, we use the modeler function. Here:</p>
<ul>
<li>x specifies the days after planting (DAP),</li>
<li>y is the canopy variable to be modeled,</li>
<li>grp allows us to perform group analysis, e.g., on multiple
plots.</li>
</ul>
<p>In this example, we have 196 plots but will only fit the model for
plots 166 and 40 as a subset. We define the piecewise function
<code>fn_lin_plat</code> and set initial values for the parameters.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod_1</span> <span class="op">&lt;-</span> <span class="va">dt_potato</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/modeler.html">modeler</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">DAP</span>,</span>
<span>    y <span class="op">=</span> <span class="va">Canopy</span>,</span>
<span>    grp <span class="op">=</span> <span class="va">Plot</span>,</span>
<span>    fn <span class="op">=</span> <span class="st">"fn_lin_plat"</span>,</span>
<span>    parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>t1 <span class="op">=</span> <span class="fl">45</span>, t2 <span class="op">=</span> <span class="fl">80</span>, k <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span>,</span>
<span>    subset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">166</span>, <span class="fl">40</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">mod_1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; Canopy ~ fn_lin_plat(DAP, t1, t2, k) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals (`Standardized`):</span></span>
<span><span class="co">#&gt;       Min.    1st Qu.     Median       Mean    3rd Qu.       Max. </span></span>
<span><span class="co">#&gt; -1.7789202 -0.0004079  0.0000000  0.0000000  0.0008157  1.7789194 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Optimization Results `head()`:</span></span>
<span><span class="co">#&gt;  uid   t1   t2   k     sse</span></span>
<span><span class="co">#&gt;   40 34.8 60.6 100  0.0545</span></span>
<span><span class="co">#&gt;  166 31.6 57.5 100 40.9135</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Metrics:</span></span>
<span><span class="co">#&gt;  Groups      Timing Convergence Iterations</span></span>
<span><span class="co">#&gt;       2 0.2412 secs        100% 551.5 (id)</span></span></code></pre></div>
<p>After fitting, we can inspect the model summary and visualize the fit
using the plot function:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod_1</span>, id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">166</span>, <span class="fl">40</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="canopy-model_files/figure-html/unnamed-chunk-9-1.png" alt="plot fit" width="768"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">mod_1</span><span class="op">$</span><span class="va">param</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">uid</th>
<th align="right">t1</th>
<th align="right">t2</th>
<th align="right">k</th>
<th align="right">sse</th>
<th align="left">fn_name</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">40</td>
<td align="right">34.84916</td>
<td align="right">60.59505</td>
<td align="right">100.0000</td>
<td align="right">0.0544833</td>
<td align="left">fn_lin_plat</td>
</tr>
<tr class="even">
<td align="right">166</td>
<td align="right">31.61374</td>
<td align="right">57.54603</td>
<td align="right">100.0047</td>
<td align="right">40.9134555</td>
<td align="left">fn_lin_plat</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="extracting-model-coefficients-and-uncertainty-measures">3.1. Extracting model coefficients and uncertainty measures<a class="anchor" aria-label="anchor" href="#extracting-model-coefficients-and-uncertainty-measures"></a>
</h2>
<p>Once the model is fitted, we can extract key statistical information,
such as coefficients, standard errors, confidence intervals, and the
variance-covariance matrix for each group (plot). These metrics allow us
to draw conclusions about the parameter estimates and assess the
uncertainty around them.</p>
<p>The functions <code>coef</code>, <code>confint</code>, and
<code>vcov</code> are used as follows:</p>
<ul>
<li>
<strong>coef</strong>: Extracts the estimated coefficients for each
group.</li>
<li>
<strong>confint</strong>: Provides the confidence intervals for the
parameter estimates.</li>
<li>
<strong>vcov</strong>: Returns the variance-covariance matrix, which
can be used to understand the relationships between the estimates and
their variability.</li>
</ul>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">mod_1</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 Ã— 7</span></span></span>
<span><span class="co">#&gt;     uid fn_name     coefficient solution std.error `t value` `Pr(&gt;|t|)`</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>    40 fn_lin_plat t1              34.8    0.024<span style="text-decoration: underline;">0</span>    <span style="text-decoration: underline;">1</span>453.    2.93<span style="color: #949494;">e</span><span style="color: #BB0000;">-15</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>    40 fn_lin_plat t2              60.6    0.036<span style="text-decoration: underline;">8</span>    <span style="text-decoration: underline;">1</span>648.    1.56<span style="color: #949494;">e</span><span style="color: #BB0000;">-15</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>    40 fn_lin_plat k              100.     0.060<span style="text-decoration: underline;">3</span>    <span style="text-decoration: underline;">1</span>659.    1.51<span style="color: #949494;">e</span><span style="color: #BB0000;">-15</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>   166 fn_lin_plat t1              31.6    0.794       39.8   1.89<span style="color: #949494;">e</span><span style="color: #BB0000;">- 7</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>   166 fn_lin_plat t2              57.5    0.902       63.8   1.79<span style="color: #949494;">e</span><span style="color: #BB0000;">- 8</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>   166 fn_lin_plat k              100.     1.65        60.6   2.32<span style="color: #949494;">e</span><span style="color: #BB0000;">- 8</span></span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">mod_1</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 Ã— 7</span></span></span>
<span><span class="co">#&gt;     uid fn_name     coefficient solution std.error ci_lower ci_upper</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>    40 fn_lin_plat t1              34.8    0.024<span style="text-decoration: underline;">0</span>     34.8     34.9</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>    40 fn_lin_plat t2              60.6    0.036<span style="text-decoration: underline;">8</span>     60.5     60.7</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>    40 fn_lin_plat k              100.     0.060<span style="text-decoration: underline;">3</span>     99.8    100. </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>   166 fn_lin_plat t1              31.6    0.794      29.6     33.7</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>   166 fn_lin_plat t2              57.5    0.902      55.2     59.9</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>   166 fn_lin_plat k              100.     1.65       95.8    104.</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">mod_1</span><span class="op">)</span></span>
<span><span class="co">#&gt; $`40`</span></span>
<span><span class="co">#&gt;               t1            t2            k</span></span>
<span><span class="co">#&gt; t1  5.755016e-04 -0.0002977975 4.429740e-08</span></span>
<span><span class="co">#&gt; t2 -2.977975e-04  0.0013525945 9.350853e-04</span></span>
<span><span class="co">#&gt; k   4.429740e-08  0.0009350853 3.632249e-03</span></span>
<span><span class="co">#&gt; attr(,"fn_name")</span></span>
<span><span class="co">#&gt; [1] "fn_lin_plat"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`166`</span></span>
<span><span class="co">#&gt;              t1         t2            k</span></span>
<span><span class="co">#&gt; t1  0.630721491 -0.2613850 -0.002831928</span></span>
<span><span class="co">#&gt; t2 -0.261385006  0.8131631  0.711976842</span></span>
<span><span class="co">#&gt; k  -0.002831928  0.7119768  2.725671099</span></span>
<span><span class="co">#&gt; attr(,"fn_name")</span></span>
<span><span class="co">#&gt; [1] "fn_lin_plat"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="providing-different-initial-values">4. Providing different initial values<a class="anchor" aria-label="anchor" href="#providing-different-initial-values"></a>
</h2>
<p>The initial fit may not always be optimal, so we can adjust the
initial parameter values for each plot and even fix certain parameters
to improve the model.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">initials</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  uid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">166</span>, <span class="fl">40</span><span class="op">)</span>,</span>
<span>  t1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">70</span>, <span class="fl">60</span><span class="op">)</span>,</span>
<span>  t2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">40</span>, <span class="fl">80</span><span class="op">)</span>,</span>
<span>  k <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">100</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">initials</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">uid</th>
<th align="right">t1</th>
<th align="right">t2</th>
<th align="right">k</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">166</td>
<td align="right">70</td>
<td align="right">40</td>
<td align="right">100</td>
</tr>
<tr class="even">
<td align="right">40</td>
<td align="right">60</td>
<td align="right">80</td>
<td align="right">100</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod_2</span> <span class="op">&lt;-</span> <span class="va">dt_potato</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/modeler.html">modeler</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">DAP</span>,</span>
<span>    y <span class="op">=</span> <span class="va">Canopy</span>,</span>
<span>    grp <span class="op">=</span> <span class="va">Plot</span>,</span>
<span>    fn <span class="op">=</span> <span class="st">"fn_lin_plat"</span>,</span>
<span>    parameters <span class="op">=</span> <span class="va">initials</span>,</span>
<span>    subset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">166</span>, <span class="fl">40</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod_2</span>, id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">166</span>, <span class="fl">40</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="canopy-model_files/figure-html/unnamed-chunk-16-1.png" alt="plot fit 2" width="768"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">mod_2</span><span class="op">$</span><span class="va">param</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">uid</th>
<th align="right">t1</th>
<th align="right">t2</th>
<th align="right">k</th>
<th align="right">sse</th>
<th align="left">fn_name</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">40</td>
<td align="right">34.84916</td>
<td align="right">60.59505</td>
<td align="right">100.0000</td>
<td align="right">5.448330e-02</td>
<td align="left">fn_lin_plat</td>
</tr>
<tr class="even">
<td align="right">166</td>
<td align="right">70.75697</td>
<td align="right">39.85048</td>
<td align="right">100.0047</td>
<td align="right">1.077531e+04</td>
<td align="left">fn_lin_plat</td>
</tr>
</tbody>
</table>
<p>Itâ€™s important to note that providing poor initial guesses for the
parameters can lead to inaccurate or unreliable model fits. For example,
if we mistakenly assign t1 (the day of plant emergence) a value greater
than t2 (the day of maximum canopy), the model fit can fail or produce
nonsensical results.</p>
</div>
<div class="section level2">
<h2 id="fixing-some-parameters-of-the-model">5. Fixing some parameters of the model<a class="anchor" aria-label="anchor" href="#fixing-some-parameters-of-the-model"></a>
</h2>
<p>In certain cases, we may want to fix specific parameters either
because they are known or because we prefer the model to leave these
parameters unchanged. For example, we can fix the parameter
<code>k</code>, which represents the maximum canopy value, as
follows:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fixed_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>k <span class="op">=</span> <span class="st">"max(y)"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod_3</span> <span class="op">&lt;-</span> <span class="va">dt_potato</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/modeler.html">modeler</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">DAP</span>,</span>
<span>    y <span class="op">=</span> <span class="va">Canopy</span>,</span>
<span>    grp <span class="op">=</span> <span class="va">Plot</span>,</span>
<span>    fn <span class="op">=</span> <span class="st">"fn_lin_plat"</span>,</span>
<span>    parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>t1 <span class="op">=</span> <span class="fl">45</span>, t2 <span class="op">=</span> <span class="fl">80</span>, k <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span>,</span>
<span>    fixed_params <span class="op">=</span> <span class="va">fixed_params</span>,</span>
<span>    subset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">166</span>, <span class="fl">40</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod_3</span>, id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">166</span>, <span class="fl">40</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="canopy-model_files/figure-html/unnamed-chunk-19-1.png" alt="plot fit 3" width="768"></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">mod_3</span><span class="op">$</span><span class="va">param</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">uid</th>
<th align="right">t1</th>
<th align="right">t2</th>
<th align="right">sse</th>
<th align="right">k</th>
<th align="left">fn_name</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">40</td>
<td align="right">34.84916</td>
<td align="right">60.59505</td>
<td align="right">0.0544833</td>
<td align="right">100.000</td>
<td align="left">fn_lin_plat</td>
</tr>
<tr class="even">
<td align="right">166</td>
<td align="right">31.61374</td>
<td align="right">57.54663</td>
<td align="right">40.9134718</td>
<td align="right">100.007</td>
<td align="left">fn_lin_plat</td>
</tr>
</tbody>
</table>
<p>By fixing k to 100, we are telling the model that the maximum canopy
for these plots is fixed at 100%. This allows the model to focus on
estimating the other parameters, t1 and t2, potentially improving the
accuracy of their estimates by reducing the complexity of the model.</p>
</div>
<div class="section level2">
<h2 id="comparing-estimations">6. Comparing estimations<a class="anchor" aria-label="anchor" href="#comparing-estimations"></a>
</h2>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind.data.frame</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">mod_1</span><span class="op">$</span><span class="va">param</span>, model <span class="op">=</span> <span class="st">"1"</span>, .before <span class="op">=</span> <span class="va">uid</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">mod_2</span><span class="op">$</span><span class="va">param</span>, model <span class="op">=</span> <span class="st">"2"</span>, .before <span class="op">=</span> <span class="va">uid</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">mod_3</span><span class="op">$</span><span class="va">param</span>, model <span class="op">=</span> <span class="st">"3"</span>, .before <span class="op">=</span> <span class="va">uid</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">uid</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fl">166</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">model</th>
<th align="right">uid</th>
<th align="right">t1</th>
<th align="right">t2</th>
<th align="right">k</th>
<th align="right">sse</th>
<th align="left">fn_name</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="right">166</td>
<td align="right">31.61374</td>
<td align="right">57.54603</td>
<td align="right">100.0047</td>
<td align="right">40.91346</td>
<td align="left">fn_lin_plat</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="right">166</td>
<td align="right">70.75697</td>
<td align="right">39.85048</td>
<td align="right">100.0047</td>
<td align="right">10775.31306</td>
<td align="left">fn_lin_plat</td>
</tr>
<tr class="odd">
<td align="left">3</td>
<td align="right">166</td>
<td align="right">31.61374</td>
<td align="right">57.54663</td>
<td align="right">100.0070</td>
<td align="right">40.91347</td>
<td align="left">fn_lin_plat</td>
</tr>
</tbody>
</table>
<p>After fitting multiple models with different initial values, fixed
parameters, and canopy adjustments, we can compare the resulting
coefficients and sum of square errors (<code>sse</code>) to evaluate the
impact of these changes.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/performance.html">performance</a></span><span class="op">(</span><span class="va">mod_1</span>, <span class="va">mod_2</span>, <span class="va">mod_3</span><span class="op">)</span></span>
<span><span class="va">comparison</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">uid</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fl">166</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table style="width:100%;" class="table">
<colgroup>
<col width="14%">
<col width="4%">
<col width="3%">
<col width="5%">
<col width="3%">
<col width="7%">
<col width="6%">
<col width="7%">
<col width="6%">
<col width="6%">
<col width="9%">
<col width="6%">
<col width="8%">
<col width="6%">
<col width="4%">
</colgroup>
<thead><tr class="header">
<th align="left">fn_name</th>
<th align="right">uid</th>
<th align="right">df</th>
<th align="right">nobs</th>
<th align="right">p</th>
<th align="right">logLik</th>
<th align="right">AIC</th>
<th align="right">AICc</th>
<th align="right">BIC</th>
<th align="right">Sigma</th>
<th align="right">SSE</th>
<th align="right">MAE</th>
<th align="right">MSE</th>
<th align="right">RMSE</th>
<th align="right">R2</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">fn_lin_plat_1</td>
<td align="right">166</td>
<td align="right">4</td>
<td align="right">8</td>
<td align="right">3</td>
<td align="right">-17.88</td>
<td align="right">43.76</td>
<td align="right">57.09</td>
<td align="right">44.08</td>
<td align="right">2.86</td>
<td align="right">40.91</td>
<td align="right">1.27</td>
<td align="right">5.11</td>
<td align="right">2.26</td>
<td align="right">1.0</td>
</tr>
<tr class="even">
<td align="left">fn_lin_plat_2</td>
<td align="right">166</td>
<td align="right">4</td>
<td align="right">8</td>
<td align="right">3</td>
<td align="right">-40.17</td>
<td align="right">88.35</td>
<td align="right">101.68</td>
<td align="right">88.67</td>
<td align="right">46.42</td>
<td align="right">10775.31</td>
<td align="right">18.88</td>
<td align="right">1346.91</td>
<td align="right">36.70</td>
<td align="right">0.3</td>
</tr>
<tr class="odd">
<td align="left">fn_lin_plat_3</td>
<td align="right">166</td>
<td align="right">3</td>
<td align="right">8</td>
<td align="right">2</td>
<td align="right">-17.88</td>
<td align="right">41.76</td>
<td align="right">47.76</td>
<td align="right">42.00</td>
<td align="right">2.61</td>
<td align="right">40.91</td>
<td align="right">1.27</td>
<td align="right">5.11</td>
<td align="right">2.26</td>
<td align="right">1.0</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">comparison</span>, id <span class="op">=</span> <span class="fl">166</span><span class="op">)</span></span></code></pre></div>
<p><img src="canopy-model_files/figure-html/unnamed-chunk-22-1.png" alt="plot fit 4" width="700"></p>
</div>
<div class="section level2">
<h2 id="making-predictions">7. Making predictions<a class="anchor" aria-label="anchor" href="#making-predictions"></a>
</h2>
<p>Once the model is fitted and validated as the best representation of
our data, we can proceed to make predictions. The
<code><a href="../reference/predict.modeler.html">predict.modeler()</a></code> function provides a range of flexible
prediction options, allowing users to perform point predictions,
calculate the area under the curve (AUC), compute first or second
derivatives, and even evaluate custom functions of the parameters. Below
are some examples demonstrating these capabilities:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Point Prediction</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mod_1</span>, x <span class="op">=</span> <span class="fl">45</span>, type <span class="op">=</span> <span class="st">"point"</span>, id <span class="op">=</span> <span class="fl">166</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">uid</th>
<th align="left">fn_name</th>
<th align="right">x_new</th>
<th align="right">predicted.value</th>
<th align="right">std.error</th>
</tr></thead>
<tbody><tr class="odd">
<td align="right">166</td>
<td align="left">fn_lin_plat</td>
<td align="right">45</td>
<td align="right">51.62246</td>
<td align="right">1.656734</td>
</tr></tbody>
</table>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># AUC Prediction</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mod_1</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">108</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"auc"</span>, id <span class="op">=</span> <span class="fl">166</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">uid</th>
<th align="left">fn_name</th>
<th align="right">x_min</th>
<th align="right">x_max</th>
<th align="right">predicted.value</th>
<th align="right">std.error</th>
</tr></thead>
<tbody><tr class="odd">
<td align="right">166</td>
<td align="left">fn_lin_plat</td>
<td align="right">0</td>
<td align="right">108</td>
<td align="right">6342.308</td>
<td align="right">93.61781</td>
</tr></tbody>
</table>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Function of the parameters</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mod_1</span>, formula <span class="op">=</span> <span class="op">~</span> <span class="va">t2</span> <span class="op">-</span> <span class="va">t1</span>, id <span class="op">=</span> <span class="fl">166</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">uid</th>
<th align="left">fn_name</th>
<th align="left">formula</th>
<th align="right">predicted.value</th>
<th align="right">std.error</th>
</tr></thead>
<tbody><tr class="odd">
<td align="right">166</td>
<td align="left">fn_lin_plat</td>
<td align="left">t2 - t1</td>
<td align="right">25.93229</td>
<td align="right">1.402375</td>
</tr></tbody>
</table>
<p>In each example, the <code><a href="../reference/predict.modeler.html">predict.modeler()</a></code> function tailors
the predictions to the userâ€™s needs, whether itâ€™s estimating a single
value, integrating across a range, or calculating a parameter-based
expression.</p>
</div>
<div class="section level2">
<h2 id="modelling-all-plots-using-parallel-processing">8. Modelling all plots using parallel processing<a class="anchor" aria-label="anchor" href="#modelling-all-plots-using-parallel-processing"></a>
</h2>
<p>Finally, we can apply this method to all 196 plots, leveraging
parallel processing to speed up the computation. To do this, we specify
<code>parallel = TRUE</code> in the options argument, and set the number
of cores using the function <code><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">parallel::detectCores()</a></code>, which
automatically detects the available cores.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="va">dt_potato</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/modeler.html">modeler</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">DAP</span>,</span>
<span>    y <span class="op">=</span> <span class="va">Canopy</span>,</span>
<span>    grp <span class="op">=</span> <span class="va">Plot</span>,</span>
<span>    fn <span class="op">=</span> <span class="st">"fn_lin_plat"</span>,</span>
<span>    parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>t1 <span class="op">=</span> <span class="fl">45</span>, t2 <span class="op">=</span> <span class="fl">80</span>, k <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span>,</span>
<span>    fixed_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>k <span class="op">=</span> <span class="st">"max(y)"</span><span class="op">)</span>,</span>
<span>    options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>progress <span class="op">=</span> <span class="cn">TRUE</span>, parallel <span class="op">=</span> <span class="cn">TRUE</span>, workers <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><br></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Johan Aparicio, Jeffrey Endelman.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
